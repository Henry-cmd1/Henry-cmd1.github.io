<html>
    <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2048 by Henry Jiang</title>
</head>
<body>
    <div id="game">
        <span class="container">
            <span class="left">
                <span class="left-topic">BNDS GPA</span>
            </span>
            <span class="right">
                <span class="score-box">Best score：<span class="score">0</span></span>
                <span class="score-box">Score：<span class="score">0</span></span>
            </span>
        </span>
        
        <div id="box">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <hr>
    <div class="context">
        <p>Use your <strong>arrow keys</strong> to move the tiles.</p>
        <p>Author: <strong>Henry Jiang</strong></p>
        <p>version: 2024/3/21</p>
    </div>
</body>
</html>

<style>
    .container{
    display: flex;
}
.context{
    color:rgb(116, 88, 52);
}

.left{
    width: auto;
    font-size: 10px;
    display: flex;
    flex-direction: column;
}

.left-topic{
    font-weight: bold;
    color:rgb(172, 130, 75);
    font-size: 20px
}
.right{
    display: flex;
    flex-direction: column;
    position: relative;
    left: 10px;
    color:blanchedalmond;
    align-self: center;
}
.score-box{
    height: 25px;
    width: auto;
    border-radius: 5px;
    font-weight: bold;
    font-size: 17px;
}
.score{
    font-weight: bold;
    font-size: 25px;
}
#game{
    width: 300px;
    height: 400px;
    background-color: #BBADA0;
    display: flex;
    justify-content: space-evenly;
    flex-wrap: wrap;
    border-radius: 0.5em;
    margin: 100px auto;
}
#box{
    display: flex;
    justify-content: space-evenly;
    flex-wrap: wrap;
    border-radius: 0.5em;
}
#box div{
    width: 60px;
    height: 60px;
    border: 1px solid transparent;
    background-color: #CDC1B4;
    font-size: 40px;
    text-align: center;
    line-height: auto;
    font-weight: bold;
    border-radius: 10px;
    margin-top: 5px;
    color:rgba(172, 141, 101, 0.911);
}
</style>

<script>
     //Author: Henry Jiang
var high = 0;
 var score = 0;
 var divs= document.querySelectorAll("#box>div");
 var arr = [[],[],[],[]];
 var num=0;

 init();
 show()

 window.onkeydown = function(e){

     switch(e.keyCode){
         case 37 :  toNum();isFull(); left();bgcolor();show();     break;//用toNum()把innerHTML转化成数字,
         case 38 :  toNum();isFull(); up();bgcolor();show();     break;
         case 39 :  toNum();isFull(); right();bgcolor();show();     break;
         case 40 :  toNum();isFull(); down(); bgcolor();show();     break;
         case 73 :  init(); break;
     } 

 }


function rand(){
var x=Math.floor(Math.random()*4);
var y=Math.floor(Math.random()*4);
if(arr[x][y].innerHTML == ""){
 arr[x][y].innerHTML = Math.random() > 0.5 ? 2 : 4;
}else{
 rand();
}
}

 function init(){
     for(var i = 0;i <arr.length;i++){
         for(var j = 0;j <arr.length;j++){
             arr[i][j] = divs[num];
             arr[i][j].innerHTML = '';
             num++;
         }
     }
     num = 0;
     if(score>high)
         document.getElementsByClassName('score')[0].innerHTML = high = score;
     document.getElementsByClassName('score')[1].innerHTML = score = 0;
     rand();
     rand();
     bgcolor();
 }

 function addScore(s) {
     score += s;
     document.getElementsByClassName('score')[1].innerHTML = score;
 }

 function isFull(){
     var bool=true;
     for(var i = 0;i <arr.length;i++){
         for(var j = 0;j <arr.length;j++){
             if(arr[i][j].innerHTML == "" ){
             bool = false;
             }
         }
     }
     if(bool){
     isChange();
     }else{
         rand();
     }
 }

 function  isChange(){
     var bool = true;
     for(var i = 0;i < arr.length-1 ;i++){
         for(var j = 0;j< arr.length-1;j++){
             if(arr[i][j].innerHTML == arr[i][j+1].innerHTML || arr[i][j].innerHTML == arr[i+1][j].innerHTML || arr[i+1][j].innerHTML == arr[i+1][j+1].innerHTML || arr[i][j+1].innerHTML == arr[i+1][j+1].innerHTML  ){
                 bool = false;
             }
         }
     }
     if(bool){
         alert("Game over! See you in OSU. Let's go BUCKEYE!");
         init();
     }
 }

 function bgcolor(){
     for(var i = 0;i <arr.length;i++){
         for(var j = 0;j <arr.length;j++){
         
         switch(arr[i][j].innerHTML){
             case '2': arr[i][j].style.backgroundColor = "#EEE4DA" ;break;
             case '4': arr[i][j].style.backgroundColor = "#EDE0C8" ;break;
             case '8': arr[i][j].style.backgroundColor = "#F2B179" ;break;
             case '16': arr[i][j].style.backgroundColor = "#F59563" ;break;
             case '32': arr[i][j].style.backgroundColor = "#F67C5F" ;break;
             case '64': arr[i][j].style.backgroundColor = "#F65E3B" ;break;
             case '128': arr[i][j].style.backgroundColor = "#EDCF72" ;break;
             case '256': arr[i][j].style.backgroundColor = "#EDCC61" ;break;
             case '512': arr[i][j].style.backgroundColor = "#EDC850" ;break;
             case '1024': arr[i][j].style.backgroundColor = "yellowgreen" ;break;
             case '2048': arr[i][j].style.backgroundColor = "perple" ;
                         init();
                         alert('You win! Now you can go to MIT');
                         break;
             default:  arr[i][j].style.backgroundColor = "#CDC1B4" ;break;     

         }
         }
     }

 }


 function right(){
     for(var i = 0;i <4;i++){
         for(var j = 0;j <4;j++){
             if( j<3&&arr[i][j].innerHTML !=""&& arr[i][j+1].innerHTML==""){
                 arr[i][j+1].innerHTML = arr[i][j].innerHTML;
                 arr[i][j].innerHTML="";
                 right();//这段现在有嵌套bug，下同理
             }else if(j<3&&arr[i][j].innerHTML !=""&& arr[i][j].innerHTML == arr[i][j+1].innerHTML){
                 arr[i][j+1].innerHTML *=2;
                 addScore(arr[i][j+1].innerHTML*1)
                 arr[i][j].innerHTML ="";
                 break;
             } 
         
         }
     }
 }


 function left(){
     for(var i = 0;i <4;i++){
         for(var j = 0;j <4;j++){
             if( j>0&&arr[i][j].innerHTML !=""&& arr[i][j-1].innerHTML==""){
                 arr[i][j-1].innerHTML = arr[i][j].innerHTML;
                 arr[i][j].innerHTML="";
                 left();
             }else if(j>0&&arr[i][j].innerHTML !=""&& arr[i][j].innerHTML == arr[i][j-1].innerHTML){
                 arr[i][j-1].innerHTML *=2;
                 addScore(arr[i][j-1].innerHTML*1)
                 arr[i][j].innerHTML ="";
                 break;
             } 
         
         }
     }
 }

 function down(){
     for(var i = 0;i <4;i++){
         for(var j = 0;j <4;j++){
             if( i<3&&arr[i][j].innerHTML !=""&& arr[i+1][j].innerHTML==""){
                 arr[i+1][j].innerHTML = arr[i][j].innerHTML;
                 arr[i][j].innerHTML="";
                 down();
             }else if(i<3&&arr[i][j].innerHTML !=""&& arr[i][j].innerHTML == arr[i+1][j].innerHTML){
                 arr[i+1][j].innerHTML *=2;
                 addScore(arr[i+1][j].innerHTML*1)
                 arr[i][j].innerHTML ="";
                 break;
             } 
         
         }
     }
 }

 function up(){
     for(var i = 0;i <4;i++){
         for(var j = 0;j <4;j++){
             if( i>0&&arr[i][j].innerHTML !=""&& arr[i-1][j].innerHTML==""){
                 arr[i-1][j].innerHTML = arr[i][j].innerHTML;
                 arr[i][j].innerHTML="";
                 up();
             }else if(i>0&&arr[i][j].innerHTML !=""&& arr[i][j].innerHTML == arr[i-1][j].innerHTML){
                 arr[i-1][j].innerHTML *=2;
                 addScore(arr[i-1][j].innerHTML*1)
                 arr[i][j].innerHTML ="";
                 break;
             } 
         
         }
     }
 }

 function show(){
    for(var i = 0;i <arr.length;i++){
        for(var j = 0;j <arr.length;j++){
        
        switch(arr[i][j].innerHTML){
            case '2': arr[i][j].innerHTML="F";break;
            case '4': arr[i][j].innerHTML="D";break;
            case '8': arr[i][j].innerHTML="C-";break;
            case '16': arr[i][j].innerHTML="C";break;
            case '32': arr[i][j].innerHTML="C+";break;
            case '64': arr[i][j].innerHTML="B-";break;
            case '128': arr[i][j].innerHTML="B";break;
            case '256': arr[i][j].innerHTML="B+";break;
            case '512': arr[i][j].innerHTML="A-";break;
            case '1024': arr[i][j].innerHTML="A";break;
            case '2048': arr[i][j].innerHTML="A+";
                        init();
                        alert('You win! Now you can go to MIT');
                        break;
            default:  arr[i][j].style.backgroundColor = "#CDC1B4" ;break;     

        }
        }
    }
 }

 function toNum(){
    for(var i = 0;i <arr.length;i++){
        for(var j = 0;j <arr.length;j++){
        
        switch(arr[i][j].innerHTML){
            case 'F': arr[i][j].innerHTML="2";break;
            case 'D': arr[i][j].innerHTML="4";break;
            case 'C-': arr[i][j].innerHTML="8";break;
            case 'C': arr[i][j].innerHTML="16";break;
            case 'C+': arr[i][j].innerHTML="32";break;
            case 'B-': arr[i][j].innerHTML="64";break;
            case 'B': arr[i][j].innerHTML="128";break;
            case 'B+': arr[i][j].innerHTML="256";break;
            case 'A-': arr[i][j].innerHTML="512";break;
            case 'A': arr[i][j].innerHTML="1024";break;
            case 'A+': arr[i][j].innerHTML="2048";break;
            default:  arr[i][j].style.backgroundColor = "#CDC1B4" ;break;     
        }
        }
    }
 }

</script>